var scene,camera,controls,fieldOfView,aspectRatio,nearPlane,farPlane,shadowLight,backLight,light,renderer,container,floor,fan,isBlowing=!1;$("#switch").is(":checked")&&(isBlowing=!0);var HEIGHT,WIDTH,windowHalfX,windowHalfY,mousePos={x:0,y:0};function init(){scene=new THREE.Scene,HEIGHT=window.innerHeight,WIDTH=window.innerWidth,aspectRatio=WIDTH/HEIGHT,fieldOfView=100,nearPlane=10,farPlane=1e3,(camera=new THREE.PerspectiveCamera(fieldOfView,aspectRatio,nearPlane,farPlane)).position.y=350,camera.position.x=-50,camera.position.z=230,camera.lookAt(new THREE.Vector3(0,0,0)),(renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0})).setPixelRatio(window.devicePixelRatio),renderer.setSize(WIDTH,HEIGHT),renderer.shadowMap.enabled=!0,(container=document.getElementById("world")).appendChild(renderer.domElement),windowHalfX=WIDTH/2,windowHalfY=HEIGHT/2,window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){HEIGHT=window.innerHeight,WIDTH=window.innerWidth,windowHalfX=WIDTH/2,windowHalfY=HEIGHT/2,renderer.setSize(WIDTH,HEIGHT),camera.aspect=WIDTH/HEIGHT,camera.updateProjectionMatrix()}function createLights(){light=new THREE.HemisphereLight(16777215,16777215,.5),(shadowLight=new THREE.DirectionalLight(16777215,.8)).position.set(200,200,200),shadowLight.castShadow=!0,shadowLight.shadowDarkness=.2,(backLight=new THREE.DirectionalLight(16777215,.4)).position.set(-100,200,50),backLight.shadowDarkness=.1,backLight.castShadow=!0,scene.add(backLight),scene.add(light),scene.add(shadowLight)}function createFloor(){(floor=new THREE.Mesh(new THREE.PlaneBufferGeometry(1e3,500),new THREE.MeshBasicMaterial({color:15459815}))).rotation.x=-Math.PI/2,floor.position.y=-100,floor.receiveShadow=!0,scene.add(floor)}function createFan(){(fan=new Fan).threegroup.position.z=100,fan.threegroup.position.y=50,scene.add(fan.threegroup)}function loop(){render();var e=mousePos.x-windowHalfX,t=mousePos.y-windowHalfY;fan.isBlowing=isBlowing,fan.update(e,t),requestAnimationFrame(loop)}function render(){controls&&controls.update(),renderer.render(scene,camera)}function clamp(e,t,i){return Math.min(Math.max(e,t),i)}function rule3(e,t,i,o,a){return o+(Math.max(Math.min(e,i),t)-t)/(i-t)*(a-o)}dist=0,Fan=function(){this.isBlowing=!1,this.speed=0,this.acc=0,this.redMat=new THREE.MeshLambertMaterial({color:11351333,shading:THREE.FlatShading}),this.greyMat=new THREE.MeshLambertMaterial({color:6635340,shading:THREE.FlatShading}),this.yellowMat=new THREE.MeshLambertMaterial({color:16634486,shading:THREE.FlatShading});var e=new THREE.BoxGeometry(10,10,20),t=new THREE.BoxGeometry(10,10,3),i=new THREE.BoxGeometry(10,30,2);i.applyMatrix4((new THREE.Matrix4).makeTranslation(0,25,0)),this.core=new THREE.Mesh(e,this.greyMat);var o=new THREE.Mesh(i,this.redMat);o.position.z=15;var a=o.clone();a.rotation.z=Math.PI/2;var n=o.clone();n.rotation.z=Math.PI;var r=o.clone();r.rotation.z=-Math.PI/2,this.sphere=new THREE.Mesh(t,this.yellowMat),this.sphere.position.z=15,this.propeller=new THREE.Group,this.propeller.add(o),this.propeller.add(a),this.propeller.add(n),this.propeller.add(r),this.threegroup=new THREE.Group,this.threegroup.add(this.core),this.threegroup.add(this.propeller),this.threegroup.add(this.sphere)},Fan.prototype.update=function(e,t){this.threegroup.lookAt(new THREE.Vector3(0,80,60)),this.tPosX=rule3(e,-200,200,-250,250),this.tPosY=rule3(t,-200,200,250,-250),this.threegroup.position.x+=(this.tPosX-this.threegroup.position.x)/10,this.threegroup.position.y+=(this.tPosY-this.threegroup.position.y)/10,this.targetSpeed=this.isBlowing?.3:.01,this.isBlowing&&this.speed<.5?(this.acc+=.001,this.speed+=this.acc):this.isBlowing||(this.acc=0,this.speed*=.98),this.propeller.rotation.z+=this.speed},init(),createLights(),createFloor(),createFan(),loop();
//# sourceMappingURL=Fan.ddad8270.js.map
